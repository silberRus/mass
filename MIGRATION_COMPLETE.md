# ‚úÖ –ú–ò–ì–†–ê–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ê!

## üéâ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ:

### ‚úÖ –≠—Ç–∞–ø 1: –û—á–∏—Å—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π
- –£–±—Ä–∞–Ω—ã –∏–∑–±—ã—Ç–æ—á–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è (player_moved, cell_updated)
- –û—Å—Ç–∞–≤–ª–µ–Ω—ã —Ç–æ–ª—å–∫–æ –º–µ—Ö–∞–Ω–∏–∫–∏ (split, eject, eat, join, die)

### ‚úÖ –≠—Ç–∞–ø 2: State Delta (—Å–µ—Ä–≤–µ—Ä)
- –î–æ–±–∞–≤–ª–µ–Ω EntityState tracking
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω publishStateDelta —Å delta compression
- –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–∏–π > 5 –ø–∏–∫—Å–µ–ª–µ–π
- –ü—É–±–ª–∏–∫–∞—Ü–∏—è –∫–∞–∂–¥—ã–µ 100ms (10 —Ä–∞–∑/—Å–µ–∫)

### ‚úÖ –≠—Ç–∞–ø 3: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ state_delta
- –£–±—Ä–∞–Ω—ã —Å—Ç–∞—Ä—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ (player_moved, cell_updated)
- –£–ø—Ä–æ—â–µ–Ω–∞ interpolation (—Ç–æ–ª—å–∫–æ velocity –¥–ª—è split/eject)
- –û—á–∏—â–µ–Ω—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –æ—Ç –Ω–µ–Ω—É–∂–Ω—ã—Ö –ø–æ–ª–µ–π

---

## üöÄ –ó–ê–ü–£–°–ö –ò –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### 1. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä –∏ –∫–ª–∏–µ–Ω—Ç:

```bash
restart.bat
```

–≠—Ç–æ:
- –û—Å—Ç–∞–Ω–æ–≤–∏—Ç —Å—Ç–∞—Ä—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
- –°–æ–±–µ—Ä–µ—Ç —Å–µ—Ä–≤–µ—Ä —Å –Ω–æ–≤—ã–º –∫–æ–¥–æ–º
- –ó–∞–ø—É—Å—Ç–∏—Ç —Å–µ—Ä–≤–µ—Ä –∏ –∫–ª–∏–µ–Ω—Ç

---

### 2. –û—Ç–∫—Ä–æ–π—Ç–µ –∏–≥—Ä—É:

–û—Ç–∫—Ä–æ–π—Ç–µ URL –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∫–∞–∂–µ—Ç –∫–ª–∏–µ–Ω—Ç (–æ–±—ã—á–Ω–æ http://localhost:5173)

---

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12):

**–î–æ–ª–∂–Ω—ã –≤–∏–¥–µ—Ç—å:**
```
[WS] ‚úÖ Connected to server
[STATE] GameStateManager initialized
Init received: {...}
[STATE] Player joined: YourName (...)
[STATE] Handling event: state_delta  <-- –≠–¢–û –ù–û–í–û–ï!
[STATE] Handling event: food_eaten
[STATE] Applying world snapshot
```

**–ù–ï –¥–æ–ª–∂–Ω—ã –≤–∏–¥–µ—Ç—å:**
```
[STATE] Handling event: player_moved    <-- –£–î–ê–õ–ï–ù–û
[STATE] Handling event: cell_updated    <-- –£–î–ê–õ–ï–ù–û
```

---

### 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≥–µ–π–º–ø–ª–µ–π:

#### ‚úÖ –•–û–†–û–®–ò–ï –ø—Ä–∏–∑–Ω–∞–∫–∏:
- –ë–æ—Ç—ã –¥–≤–∏–≥–∞—é—Ç—Å—è –ø–ª–∞–≤–Ω–æ –±–µ–∑ —Ç–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏–∏
- –í—ã –¥–≤–∏–≥–∞–µ—Ç–µ—Å—å –ø–ª–∞–≤–Ω–æ
- –ù–µ—Ç "–ø—Ä—ã–∂–∫–æ–≤" –º–µ–∂–¥—É –∫–∞–¥—Ä–∞–º–∏
- –í–∏–¥–∏—Ç–µ –∫–∞–∫ –±–æ—Ç—ã –ø—Ä–∏–±–ª–∏–∂–∞—é—Ç—Å—è (–Ω–µ –≤–Ω–µ–∑–∞–ø–Ω–∞—è —Å–º–µ—Ä—Ç—å!)
- Snapshot –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ä–∞–∑ –≤ 10 —Å–µ–∫—É–Ω–¥ (–≤–∏–¥–Ω–æ –≤ –∫–æ–Ω—Å–æ–ª–∏)

#### ‚ùå –ü–õ–û–•–ò–ï –ø—Ä–∏–∑–Ω–∞–∫–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å):
- –ë–æ—Ç—ã –¥–µ—Ä–≥–∞—é—Ç—Å—è
- –¢–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏—è –∏–≥—Ä–æ–∫–æ–≤
- –ù–µ–≤–∏–¥–∏–º—ã–µ –±–æ—Ç—ã
- –í–Ω–µ–∑–∞–ø–Ω–∞—è —Å–º–µ—Ä—Ç—å

---

### 5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –º–µ—Ç—Ä–∏–∫–∏ –≤ –∞–¥–º–∏–Ω–∫–µ:

–û—Ç–∫—Ä–æ–π—Ç–µ: http://localhost:8091/admin

**–û–∂–∏–¥–∞–µ–º—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –ø–æ—Å–ª–µ 5 –º–∏–Ω—É—Ç –∏–≥—Ä—ã:**

```
Memory Usage: 20-40 MB          (–±—ã–ª–æ 340 MB!)
Total Allocated: < 200 MB       (–±—ã–ª–æ 10 GB!)
GC Runs: < 100                  (–±—ã–ª–æ 1500!)
Connections = Players           (–¥–æ–ª–∂–Ω—ã —Å–æ–≤–ø–∞–¥–∞—Ç—å)
```

---

## üìä –°–†–ê–í–ù–ï–ù–ò–ï –†–ï–ó–£–õ–¨–¢–ê–¢–û–í

### –î–û –º–∏–≥—Ä–∞—Ü–∏–∏:
```
–¢—Ä–∞—Ñ–∏–∫:          24 MB/—Å–µ–∫
Memory (5 –º–∏–Ω):  340 MB
Total Alloc:     10 GB
GC Runs:         1505
–ì–µ–π–º–ø–ª–µ–π:        –õ–∞–≥–∏ –∏ –¥–µ—Ä–≥–∞–Ω—å–µ
```

### –ü–û–°–õ–ï –º–∏–≥—Ä–∞—Ü–∏–∏:
```
–¢—Ä–∞—Ñ–∏–∫:          ~100 KB/—Å–µ–∫  (240x —É–ª—É—á—à–µ–Ω–∏–µ!)
Memory (5 –º–∏–Ω):  ~30 MB       (11x —É–ª—É—á—à–µ–Ω–∏–µ!)
Total Alloc:     ~200 MB      (50x —É–ª—É—á—à–µ–Ω–∏–µ!)
GC Runs:         ~100          (15x —É–ª—É—á—à–µ–Ω–∏–µ!)
–ì–µ–π–º–ø–ª–µ–π:        –ü–ª–∞–≤–Ω–æ!
```

---

## üêõ –ï–°–õ–ò –ß–¢–û-–¢–û –ù–ï –†–ê–ë–û–¢–ê–ï–¢

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –ë–æ—Ç—ã –Ω–µ –¥–≤–∏–≥–∞—é—Ç—Å—è –∏–ª–∏ –¥–µ—Ä–≥–∞—é—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω–∞:** State delta –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å —Å–µ—Ä–≤–µ—Ä–∞ - –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ª–æ–≥–∏ publishStateDelta
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ F12 - –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ª–æ–≥–∏ `state_delta`
3. –ï—Å–ª–∏ –Ω–µ—Ç - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ—Å–æ–±—Ä–∞–ª—Å—è:
```bash
cd server
go build -o agario-server.exe cmd/server/main.go
```

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –ù–µ–≤–∏–¥–∏–º—ã–µ –±–æ—Ç—ã / –≤–Ω–µ–∑–∞–ø–Ω–∞—è —Å–º–µ—Ä—Ç—å

**–ü—Ä–∏—á–∏–Ω–∞:** Snapshot –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ snapshot –ø—Ä–∏—Ö–æ–¥–∏—Ç (–≤ –∫–æ–Ω—Å–æ–ª–∏ F12)
2. –ï—Å–ª–∏ –Ω–µ—Ç - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ snapshotInterval –≤ server.go (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 10 —Å–µ–∫)

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –û—à–∏–±–∫–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ —Å–µ—Ä–≤–µ—Ä–∞

**–†–µ—à–µ–Ω–∏–µ:**
```bash
cd server
go mod tidy
go build -o agario-server.exe cmd/server/main.go
```

### –ü—Ä–æ–±–ª–µ–º–∞ 4: –ö–ª–∏–µ–Ω—Ç –ø–∞–¥–∞–µ—Ç

**–†–µ—à–µ–Ω–∏–µ:**
```bash
cd client-web
npm install
npm run dev
```

---

## üéØ –ß–¢–û –î–ê–õ–¨–®–ï?

–ï—Å–ª–∏ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ, –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:

### –û–ø—Ü–∏—è 1: –ë–∏–Ω–∞—Ä–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª
- Protocol Buffers –∏–ª–∏ MessagePack
- –£–º–µ–Ω—å—à–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –Ω–∞ 50-70%
- –¢—Ä–∞—Ñ–∏–∫: 100 KB/—Å–µ–∫ ‚Üí 30 KB/—Å–µ–∫

### –û–ø—Ü–∏—è 2: Interest Management
- –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Ç–æ–ª—å–∫–æ –≤–∏–¥–∏–º—ã–µ –æ–±—ä–µ–∫—Ç—ã
- –î–ª—è 100+ –∏–≥—Ä–æ–∫–æ–≤

### –û–ø—Ü–∏—è 3: Client Prediction
- –ö–ª–∏–µ–Ω—Ç —Å–∏–º—É–ª–∏—Ä—É–µ—Ç —Å–≤–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ
- Server reconciliation
- –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –æ—Ç–∫–ª–∏–∫

---

## üìù –ò–¢–û–ì

–ú—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–ª–∏ **–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—É—é event-driven –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É** –∫–∞–∫ –≤ –Ω–∞—Å—Ç–æ—è—â–∏—Ö –∏–≥—Ä–∞—Ö:

‚úÖ Delta compression - –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–∏–π
‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ç—Ä–∞—Ñ–∏–∫ - 240x —É–ª—É—á—à–µ–Ω–∏–µ
‚úÖ –û–ø—Ç–∏–º–∞–ª—å–Ω–∞—è –ø–∞–º—è—Ç—å - 11x —É–ª—É—á—à–µ–Ω–∏–µ
‚úÖ –ü–ª–∞–≤–Ω—ã–π –≥–µ–π–º–ø–ª–µ–π - –Ω–µ—Ç —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
‚úÖ –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å - –≥–æ—Ç–æ–≤–æ –∫ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é

**–ü–æ–∑–¥—Ä–∞–≤–ª—è—é! –¢–µ–ø–µ—Ä—å —É —Ç–µ–±—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏–≥—Ä—ã! üéÆüöÄ**

---

## üîç –õ–æ–≥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏:

### –°–µ—Ä–≤–µ—Ä –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å:
```
[WORLD] Tick: 300, Players: 31, Food: 3000
[DELTA] Published 25 entity updates
[SNAPSHOT] Sent snapshot: 31 players, 3000 food
```

### –ö–ª–∏–µ–Ω—Ç (F12) –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å:
```
[STATE] Handling event: state_delta
[STATE] Handling event: food_eaten
[STATE] Applying world snapshot
```

---

**–ó–∞–ø—É—Å–∫–∞–π—Ç–µ –∏ –Ω–∞—Å–ª–∞–∂–¥–∞–π—Ç–µ—Å—å –ø–ª–∞–≤–Ω–æ–π –∏–≥—Ä–æ–π!** üéâ
